<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>WebView-APIs | ZQiang94</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="WebView APIs 碎言1.Android 4.4之前，内核为WebKit，之后为chromium内核，主要是提升了性能以及对H5、CSS3、JavaScript的支持。 2.WebView继承自AbsoluteLayout,即可以在内部添加布局。1234public class WebView extends AbsoluteLayout        implements ViewTre">
<meta name="keywords">
<meta property="og:type" content="article">
<meta property="og:title" content="WebView-APIs">
<meta property="og:url" content="http://ZQiang94.github.io/2017/05/10/README17/index.html">
<meta property="og:site_name" content="ZQiang94">
<meta property="og:description" content="WebView APIs 碎言1.Android 4.4之前，内核为WebKit，之后为chromium内核，主要是提升了性能以及对H5、CSS3、JavaScript的支持。 2.WebView继承自AbsoluteLayout,即可以在内部添加布局。1234public class WebView extends AbsoluteLayout        implements ViewTre">
<meta property="og:updated_time" content="2017-06-23T02:45:27.099Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WebView-APIs">
<meta name="twitter:description" content="WebView APIs 碎言1.Android 4.4之前，内核为WebKit，之后为chromium内核，主要是提升了性能以及对H5、CSS3、JavaScript的支持。 2.WebView继承自AbsoluteLayout,即可以在内部添加布局。1234public class WebView extends AbsoluteLayout        implements ViewTre">
  
    <link rel="alternate" href="/atom.xml" title="ZQiang94" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://ZQiang94.github.io"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ZQiang94</a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-README17" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/05/10/README17/" class="article-date">
  <time datetime="2017-05-09T16:00:00.000Z" itemprop="datePublished">2017-05-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      WebView-APIs
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>WebView APIs</p>
<h3 id="碎言"><a href="#碎言" class="headerlink" title="碎言"></a>碎言</h3><p>1.Android 4.4之前，内核为WebKit，之后为chromium内核，主要是提升了性能以及对H5、CSS3、JavaScript的支持。</p>
<p>2.WebView继承自AbsoluteLayout,即可以在内部添加布局。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">WebView</span> <span class="keyword">extends</span> <span class="title">AbsoluteLayout</span></span></div><div class="line">        <span class="title">implements</span> <span class="title">ViewTreeObserver</span>.<span class="title">OnGlobalFocusChangeListener</span>,</div><div class="line">        <span class="title">ViewGroup</span>.<span class="title">OnHierarchyChangeListener</span>, <span class="title">ViewDebug</span>.<span class="title">HierarchyHandler</span> &#123;</div><div class="line">......</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<h3 id="WebView-APIs"><a href="#WebView-APIs" class="headerlink" title="WebView APIs"></a>WebView APIs</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span> getUrl()：</div><div class="line">获取当前页面的URL。</div><div class="line"></div><div class="line">reload()：</div><div class="line">重新reload当前的URL，即刷新。</div><div class="line"></div><div class="line">boolean canGoBack()：</div><div class="line">用来确认WebView里是否还有可回退的历史记录。通常我们会在WebView里重写返回键的点击事件，</div><div class="line">通过该方法判断WebView里是否还有历史记录，若有则返回上一页。</div><div class="line"></div><div class="line">boolean canGoForward()：</div><div class="line">用来确认WebView是否还有可向前的历史记录。</div><div class="line"></div><div class="line">boolean canGoBackOrForward(int steps)：</div><div class="line">以当前的页面为起始点，用来确认WebView的历史记录是否足以后退或前进给定的步数，正数为前进，负数为后退。</div><div class="line"></div><div class="line">goBack()：</div><div class="line">在WebView历史记录后退到上一项。</div><div class="line"></div><div class="line">goForward()：</div><div class="line">在WebView历史记录里前进到下一项。</div><div class="line"></div><div class="line">goBackOrForward(int steps)：</div><div class="line">以当前页面为起始点，前进或后退历史记录中指定的步数，正数为前进，负数为后退。</div><div class="line"></div><div class="line">clearCache(boolean includeDiskFiles)：</div><div class="line">清空网页访问留下的缓存数据。需要注意的时，由于缓存是全局的，所以只要是WebView用到的缓存都会被清空，即便其他地方也会使用到。</div><div class="line">该方法接受一个参数，从命名即可看出作用。若设为<span class="literal">false</span>，则只清空内存里的资源缓存，而不清空磁盘里的。</div><div class="line"></div><div class="line">clearHistory()：</div><div class="line">清除当前webview访问的历史记录。</div><div class="line"></div><div class="line">clearFormData()：</div><div class="line">清除自动完成填充的表单数据。需要注意的是，该方法仅仅清除当前表单域自动完成填充的表单数据，</div><div class="line">并不会清除WebView存储到本地的数据。</div><div class="line"></div><div class="line">onPause()：</div><div class="line">当页面被失去焦点被切换到后台不可见状态，需要执行onPause操作，该操作会通知内核安全地暂停所有动作，</div><div class="line">比如动画的执行或定位的获取等。需要注意的是该方法并不会暂停JavaScript的执行，若要暂停JavaScript的执行请使用接下来的这个方法。</div><div class="line"></div><div class="line">onResume()：</div><div class="line">在先前调用onPause()后，我们可以调用该方法来恢复WebView的运行。</div><div class="line"></div><div class="line">pauseTimers()：</div><div class="line">该方法面向全局整个应用程序的webview，它会暂停所有webview的layout，parsing，JavaScript Timer。当程序进入后台时，</div><div class="line">该方法的调用可以降低CPU功耗。</div><div class="line"></div><div class="line">resumeTimers()：</div><div class="line">恢复pauseTimers时的所有操作。</div><div class="line"></div><div class="line">destroy()：</div><div class="line">销毁WebView。需要注意的是：这个方法的调用应在WebView从父容器中被remove掉之后。我们可以手动地调用</div><div class="line">   rootLayout.removeView(webView);</div><div class="line">   webView.destroy();</div><div class="line"></div><div class="line">getScrollY()：</div><div class="line">该方法返回的当前可见区域的顶端距整个页面顶端的距离，也就是当前内容滚动的距离。</div><div class="line"></div><div class="line">getHeight()：</div><div class="line">方法都返回当前WebView这个容器的高度。其实以上两个方法都属于View。</div><div class="line"></div><div class="line">getContentHeight()：</div><div class="line">该方法返回整个HTML页面的高度，但该高度值并不等同于当前整个页面的高度，因为WebView有缩放功能， 所以当前整个页面的高度实际上应该是原始HTML的高度再乘上缩放比例。因此，准确的判断方法应该是。</div><div class="line"></div><div class="line"><span class="keyword">if</span> (webView.getContentHeight() * webView.getScale() == (webView.getHeight() + webView.getScrollY())) &#123;</div><div class="line">      <span class="comment">//已经处于底端</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span>(webView.getScrollY() == <span class="number">0</span>)&#123;</div><div class="line">      <span class="comment">//处于顶端</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">pageUp(boolean top)：</div><div class="line">将WebView展示的页面滑动至顶部。</div><div class="line"></div><div class="line">pageDown(boolean bottom)：</div><div class="line">将WebView展示的页面滑动至底部。</div></pre></td></tr></table></figure>
<h3 id="WebSetting"><a href="#WebSetting" class="headerlink" title="WebSetting"></a>WebSetting</h3><p>WebSettings是用来管理WebView配置的类。当WebView第一次创建时，内部会包含一个默认配置的集合。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line">setJavaScriptEnabled(boolean flag)：</div><div class="line">设置WebView是否可以运行JavaScript。 </div><div class="line"></div><div class="line">setJavaScriptCanOpenWindowsAutomatically(boolean flag)：</div><div class="line">设置WebView是否可以由JavaScript自动打开窗口，默认为false，通常与JavaScript的window.open()配合使用。</div><div class="line"></div><div class="line">setAllowFileAccess(boolean allow)：</div><div class="line">启用或禁用WebView访问文件数据。</div><div class="line"></div><div class="line">setBlockNetworkImage(boolean flag)：</div><div class="line">禁止或允许WebView从网络上加载图片。需要注意的是，如果设置是从禁止到允许的转变的话，图片数据并不会在设置改变后立刻去获取，</div><div class="line">而是在WebView调用reload()的时候才会生效。</div><div class="line">这个时候，需要确保这个app拥有访问Internet的权限，否则会抛出安全异常。</div><div class="line">通常没有禁止图片加载的需求的时候，完全不用管这个方法，因为当我们的app拥有访问Internet的权限时，这个flag的默认值就是false。</div><div class="line"></div><div class="line">setSupportZoom(boolean support)：</div><div class="line">设置是否支持缩放。</div><div class="line"></div><div class="line">setBuiltInZoomControls(boolean enabled)：</div><div class="line">显示或不显示缩放按钮（wap网页不支持）。</div><div class="line"></div><div class="line">setSupportMultipleWindows(boolean support)：</div><div class="line">设置WebView是否支持多窗口。</div><div class="line"></div><div class="line">setLayoutAlgorithm(WebSettings.LayoutAlgorithm l)：</div><div class="line">指定WebView的页面布局显示形式，调用该方法会引起页面重绘。默认值为LayoutAlgorithm#NARROW_COLUMNS。</div><div class="line"></div><div class="line">setNeedInitialFocus(boolean flag)：</div><div class="line">通知WebView是否需要设置一个节点获取焦点当WebView#requestFocus(int,android.graphics.Rect)被调用时，默认为true。</div><div class="line"></div><div class="line">setAppCacheEnabled(boolean flag)：</div><div class="line">启用或禁用应用缓存。</div><div class="line"></div><div class="line">setAppCachePath(String appCachePath)：</div><div class="line">设置应用缓存路径，这个路径必须是可以让app写入文件的。该方法应该只被调用一次，重复调用会被无视~</div><div class="line"></div><div class="line">setCacheMode(int mode)：</div><div class="line">用来设置WebView的缓存模式。当我们加载页面或从上一个页面返回的时候，会按照设置的缓存模式去检查并使用（或不使用）缓存。</div><div class="line">缓存模式有四种：</div><div class="line">LOAD_DEFAULT：默认的缓存使用模式。在进行页面前进或后退的操作时，如果缓存可用并未过期就优先加载缓存，否则从网络上加载数据。</div><div class="line">这样可以减少页面的网络请求次数。</div><div class="line">LOAD_CACHE_ELSE_NETWORK：只要缓存可用就加载缓存，哪怕它们已经过期失效。如果缓存不可用就从网络上加载数据。</div><div class="line">LOAD_NO_CACHE：不加载缓存，只从网络加载数据。</div><div class="line">LOAD_CACHE_ONLY：不从网络加载数据，只从缓存加载数据。</div><div class="line">通常我们可以根据网络情况将这几种模式结合使用，比如有网的时候使用LOAD_DEFAULT，离线时使用LOAD_CACHE_ONLY、LOAD_CACHE_ELSE_NETWORK，让用户不至于在离线时啥都看不到</div><div class="line"></div><div class="line">setDatabaseEnabled(boolean flag)：</div><div class="line">启用或禁用数据库缓存。</div><div class="line"></div><div class="line">setDomStorageEnabled(boolean flag)：</div><div class="line">启用或禁用DOM缓存。</div><div class="line"></div><div class="line">setUserAgentString(String ua)：</div><div class="line">设置WebView的UserAgent值。</div><div class="line"></div><div class="line">setDefaultEncodingName(String encoding)：</div><div class="line">设置编码格式，通常都设为“UTF-8”。</div><div class="line"></div><div class="line">setStandardFontFamily(String font)：</div><div class="line">设置标准的字体族，默认“sans-serif”。</div><div class="line"></div><div class="line">setCursiveFontFamily：</div><div class="line">设置草书字体族，默认“cursive”。</div><div class="line"></div><div class="line">setFantasyFontFamily：</div><div class="line">设置CursiveFont字体族，默认“cursive”。</div><div class="line"></div><div class="line">setFixedFontFamily：</div><div class="line">设置混合字体族，默认“monospace”。</div><div class="line"></div><div class="line">setSansSerifFontFamily：</div><div class="line">设置梵文字体族，默认“sans-serif”。</div><div class="line"></div><div class="line">setSerifFontFamily：</div><div class="line">设置衬线字体族，默认“sans-serif”</div><div class="line"></div><div class="line">setDefaultFixedFontSize(int size)：</div><div class="line">设置默认填充字体大小，默认16，取值区间为[1-72]，超过范围，使用其上限值。</div><div class="line"></div><div class="line">setDefaultFontSize(int size)：</div><div class="line">设置默认字体大小，默认16，取值区间[1-72]，超过范围，使用其上限值。</div><div class="line"></div><div class="line">setMinimumFontSize：</div><div class="line">设置最小字体，默认8. 取值区间[1-72]，超过范围，使用其上限值。</div><div class="line"></div><div class="line">setMinimumLogicalFontSize：</div><div class="line">设置最小逻辑字体，默认8. 取值区间[1-72]，超过范围，使用其上限值。</div></pre></td></tr></table></figure></p>
<h3 id="WebViewClinet"><a href="#WebViewClinet" class="headerlink" title="WebViewClinet"></a>WebViewClinet</h3><p>帮助WebView处理各种通知和请求事件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">onLoadResource(WebView view, <span class="built_in">String</span> url)：</div><div class="line">该方法在加载页面资源时会回调，每一个资源（比如图片）的加载都会调用一次。</div><div class="line"></div><div class="line"></div><div class="line">onPageStarted(WebView view, <span class="built_in">String</span> url, Bitmap favicon)：</div><div class="line">该方法在WebView开始加载页面且仅在Main frame loading（即整页加载）时回调，一次Main frame的加载只会回调该方法一次。我们可以在这个方法里设定开启一个加载的动画，告诉用户程序在等待网络的响应。</div><div class="line"></div><div class="line"></div><div class="line">onPageFinished(WebView view, <span class="built_in">String</span> url)：</div><div class="line">该方法只在WebView完成一个页面加载时调用一次（同样也只在Main frame loading时调用），我们可以可以在此时关闭加载动画，进行其他操作。</div><div class="line"></div><div class="line"></div><div class="line">onReceivedError(WebView view, WebResourceRequest request, WebResourceError error)：</div><div class="line">该方法在web页面加载错误时回调，这些错误通常都是由无法与服务器正常连接引起的，最常见的就是网络问题。</div><div class="line">这个方法有两个地方需要注意：</div><div class="line"><span class="number">1.</span>这个方法只在与服务器无法正常连接时调用，类似于服务器返回错误码的那种错误（即HTTP ERROR），</div><div class="line">	该方法是不会回调的，因为你已经和服务器正常连接上了;</div><div class="line"><span class="number">2.</span>这个方法是新版本的onReceivedError()方法，从API23开始引进，与旧方法</div><div class="line">	onReceivedError(WebView view,int errorCode,<span class="built_in">String</span> description,<span class="built_in">String</span> failingUrl)不同的是，新方法在页面局部加载发生错误时也会被调用（比如页面里两个子Tab或者一张图片）。</div><div class="line">	这就意味着该方法的调用频率可能会更加频繁，所以我们应该在该方法里执行尽量少的操作。</div><div class="line"></div><div class="line"></div><div class="line">onReceivedHttpError(WebView view, WebResourceRequest request, WebResourceResponse errorResponse)：</div><div class="line">上一个方法提到onReceivedError并不会在服务器返回错误码时被回调，那么当我们需要捕捉HTTP ERROR并进行相应操作时应该怎么办呢？</div><div class="line">API23便引入了该方法。当服务器返回一个HTTP ERROR并且它的status code&gt;=<span class="number">400</span>时，该方法便会回调。这个方法的作用域并不局限于Main Frame，</div><div class="line">任何资源的加载引发HTTP ERROR都会引起该方法的回调，所以我们也应该在该方法里执行尽量少的操作，只进行非常必要的错误处理等。</div><div class="line"></div><div class="line"></div><div class="line">onReceivedSslError(WebView view, SslErrorHandler handler, SslError error)：</div><div class="line">当WebView加载某个资源引发SSL错误时会回调该方法，这时WebView要么执行handler.cancel()取消加载，要么执行handler.proceed()方法继续加载（默认为cancel）。</div><div class="line">需要注意的是，这个决定可能会被保留并在将来再次遇到SSL错误时执行同样的操作。</div><div class="line"></div><div class="line"></div><div class="line">WebResourceResponse shouldInterceptRequest(WebView view, WebResourceRequest request)：</div><div class="line">当WebView需要请求某个数据时，这个方法可以拦截该请求来告知app并且允许app本身返回一个数据来替代我们原本要加载的数据。</div><div class="line">比如你对web的某个js做了本地缓存，希望在加载该js时不再去请求服务器而是可以直接读取本地缓存的js，</div><div class="line">这个方法就可以帮助你完成这个需求。你可以写一些逻辑检测这个request，并返回相应的数据，你返回的数据就会被WebView使用，</div><div class="line">如果你返回<span class="literal">null</span>，WebView会继续向服务器请求。</div><div class="line"></div><div class="line"></div><div class="line">boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request)：</div><div class="line">当我们没有给WebView提供WebViewClient时，WebView如果要加载一个url会向ActivityManager寻求一个适合的处理者</div><div class="line">来加载该url（比如系统自带的浏览器），这通常是我们不想看到的。于是我们需要给WebView提供一个WebViewClient，</div><div class="line">并重写该方法返回<span class="literal">true</span>来告知WebView url的加载就在app中进行。这时便可以实现在app内访问网页。</div><div class="line"></div><div class="line">onScaleChanged(WebView view, float oldScale, float newScale)：</div><div class="line">当WebView得页面Scale值发生改变时回调。</div><div class="line"></div><div class="line"></div><div class="line">boolean shouldOverrideKeyEvent(WebView view, KeyEvent event)：</div><div class="line">默认值为<span class="literal">false</span>，重写此方法并<span class="keyword">return</span> <span class="literal">true</span>可以让我们在WebView内处理按键事件。</div></pre></td></tr></table></figure></p>
<h3 id="WebChromeClient"><a href="#WebChromeClient" class="headerlink" title="WebChromeClient"></a>WebChromeClient</h3><p>辅助WebView处理Javascript的对话框，网站图标，网站title，加载进度等<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">onProgressChanged(WebView view, int newProgress)：</div><div class="line">当页面加载的进度发生改变时回调，用来告知主程序当前页面的加载进度。</div><div class="line"></div><div class="line">onReceivedIcon(WebView view, Bitmap icon)：</div><div class="line">用来接收web页面的icon，我们可以在这里将该页面的icon设置到Toolbar。</div><div class="line"></div><div class="line">onReceivedTitle(WebView view, <span class="built_in">String</span> title)：</div><div class="line">用来接收web页面的title，我们可以在这里将页面的title设置到Toolbar。</div><div class="line"></div><div class="line"></div><div class="line">以下两个方法是为了支持web页面进入全屏模式而存在的（比如播放视频），如果不实现这两个方法，该web上的内容便不能进入全屏模式。</div><div class="line">onShowCustomView(View view, WebChromeClient.CustomViewCallback callback)：</div><div class="line">该方法在当前页面进入全屏模式时回调，主程序必须提供一个包含当前web内容（视频 or Something）的自定义的View。</div><div class="line"></div><div class="line">onHideCustomView()：</div><div class="line">该方法在当前页面退出全屏模式时回调，主程序应在这时隐藏之前show出来的View。</div><div class="line"></div><div class="line"></div><div class="line">Bitmap getDefaultVideoPoster()：</div><div class="line">当我们的Web页面包含视频时，我们可以在HTML里为它设置一个预览图，WebView会在绘制页面时根据它的宽高为它布局。</div><div class="line">而当我们处于弱网状态下时，我们没有比较快的获取该图片，那WebView绘制页面时的gitWidth()方法就会报出空指针异常~ 于是app就crash了。</div><div class="line">这时我们就需要重写该方法，在我们尚未获取web页面上的video预览图时，给予它一个本地的图片，避免空指针的发生。</div><div class="line"></div><div class="line">View getVideoLoadingProgressView()：</div><div class="line">重写该方法可以在视频loading时给予一个自定义的View，可以是加载圆环 or something。</div><div class="line"></div><div class="line">boolean onJsAlert(WebView view, <span class="built_in">String</span> url, <span class="built_in">String</span> message, JsResult result)：</div><div class="line">处理Javascript中的Alert对话框。</div><div class="line"></div><div class="line">boolean onJsPrompt(WebView view, <span class="built_in">String</span> url, <span class="built_in">String</span> message, <span class="built_in">String</span> defaultValue, JsPromptResult result)：</div><div class="line">处理Javascript中的Prompt对话框。</div><div class="line"></div><div class="line">boolean onJsConfirm(WebView view, <span class="built_in">String</span> url, <span class="built_in">String</span> message, JsResult result)：</div><div class="line">处理Javascript中的Confirm对话框</div><div class="line"></div><div class="line">boolean onShowFileChooser(WebView webView, ValueCallback filePathCallback, WebChromeClient.FileChooserParams fileChooserParams)：</div><div class="line">该方法在用户进行了web上某个需要上传文件的操作时回调。我们应该在这里打开一个文件选择器，</div><div class="line">如果要取消这个请求我们可以调用filePathCallback.onReceiveValue(<span class="literal">null</span>)并返回<span class="literal">true</span>。</div><div class="line"></div><div class="line">onPermissionRequest(PermissionRequest request)：</div><div class="line">该方法在web页面请求某个尚未被允许或拒绝的权限时回调，主程序在此时调用grant(<span class="built_in">String</span> [])或deny()方法。</div><div class="line">如果该方法没有被重写，则默认拒绝web页面请求的权限。</div><div class="line"></div><div class="line">onPermissionRequestCanceled(PermissionRequest request)：</div><div class="line">该方法在web权限申请权限被取消时回调，这时应该隐藏任何与之相关的UI界面。</div></pre></td></tr></table></figure></p>
<h3 id="原文链接"><a href="#原文链接" class="headerlink" title="原文链接"></a>原文链接</h3><p><a href="https://zhuanlan.zhihu.com/p/22247021" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/22247021</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ZQiang94.github.io/2017/05/10/README17/" data-id="cj2ljjbhd0000wolljsoia2n3" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/05/05/README16/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          SDK目录讲解
        
      </div>
    </a>
  
  
    <a href="/2017/05/10/README13/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">WebView-js与native的交互</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    

  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">文章目录</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#碎言"><span class="toc-number">1.</span> <span class="toc-text">碎言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebView-APIs"><span class="toc-number">2.</span> <span class="toc-text">WebView APIs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebSetting"><span class="toc-number">3.</span> <span class="toc-text">WebSetting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebViewClinet"><span class="toc-number">4.</span> <span class="toc-text">WebViewClinet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebChromeClient"><span class="toc-number">5.</span> <span class="toc-text">WebChromeClient</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原文链接"><span class="toc-number">6.</span> <span class="toc-text">原文链接</span></a></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
    
  
    <!--微信公众号二维码-->


  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2016 - 2017 ZQiang94&nbsp;|&nbsp;
      主题 <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
	<div id="footer-center">
		<span id="busuanzi_container_site_pv">
		本站总访问量<span id="busuanzi_value_site_pv"></span>次
		</span>
	</div>
     <div id="footer-right">
      联系方式&nbsp;|&nbsp;zhangqiang452608069@gmail.com
    </div>
  </div>
</footer>
 <script src="/jquery/jquery.min.js"></script>
 <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      

  
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "e2fb4051c49842xxce669e634bc983f",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
    

  



  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


 <script src="/js/is.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/elevator.js"></script>
  </div>
</body>
</html>

<a href="https://github.com/ZQiang94"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>